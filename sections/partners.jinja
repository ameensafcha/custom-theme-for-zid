<section
  section-id="{{ sectionId }}"
  class="px-4 py-6 md:px-16 md:pt-0 md:pb-16"
>
  <div class="theme-container space-y-6">
    {% if settings.title %}
      <h2 class="text-foreground text-h4 md:text-h3">{{ settings.title }}</h2>
    {% endif %}
    {% if settings.store_partners %}
      <div class="embla relative overflow-hidden">
        <div class="fade-left pointer-events-none absolute top-0 z-10 h-full w-20 ltr:left-0 rtl:right-0"></div>
        <div class="fade-right pointer-events-none absolute top-0 z-10 h-full w-20 ltr:right-0 rtl:left-0"></div>
        <div class="embla__viewport overflow-hidden">
          <div class="embla__container">
            {% for partner in settings.store_partners %}
              <div class="embla__slide">
                <div class="flex h-[72px] w-[138px] shrink-0 items-center justify-center">
                  {% if partner.url %}
                    <a
                      href="{{ partner.url }}"
                      class="flex h-full w-full items-center justify-center"
                    >
                      <img
                        src="{{ partner.image }}"
                        alt="{{ partner.name }}"
                        class="h-10 w-auto object-contain"
                        loading="lazy"
                      />
                    </a>
                  {% else %}
                    <img
                      src="{{ partner.image }}"
                      alt="{{ partner.name }}"
                      class="h-10 w-auto object-contain"
                      loading="lazy"
                    />
                  {% endif %}
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
      </div>
    {% endif %}
  </div>
  <style>
    .fade-left {
      background: linear-gradient(to right, var(--color-background) 0%, transparent 100%);
    }

    .fade-right {
      background: linear-gradient(to left, var(--color-background) 0%, transparent 100%);
    }

    [dir="rtl"] .fade-left {
      background: linear-gradient(to left, var(--color-background) 0%, transparent 100%);
    }

    [dir="rtl"] .fade-right {
      background: linear-gradient(to right, var(--color-background) 0%, transparent 100%);
    }
    [section-id="{{ sectionId }}"] .embla {
      --slide-spacing: 2rem; /* gap-8 = 32px from Figma */
    }

    [section-id="{{ sectionId }}"] .embla__container {
      display: flex;
      touch-action: pan-y pinch-zoom;
    }

    [section-id="{{ sectionId }}"] .embla__slide {
      transform: translate3d(0, 0, 0);
      flex: 0 0 auto;
      min-width: 0;
      padding-left: var(--slide-spacing);
    }
  </style>
</section>

<script>
  (function () {
    const section = document.querySelector('[section-id="{{ sectionId }}"]');
    if (!section) return;

    const emblaRoot = section.querySelector(".embla");
    const viewport = emblaRoot.querySelector(".embla__viewport");
    const container = emblaRoot.querySelector(".embla__container");

    if (!container || container.children.length === 0) return;

    const autoScroll = EmblaCarouselAutoScroll({
      speed: 0.5,
      stopOnInteraction: false,
      stopOnMouseEnter: true,
      stopOnFocusIn: false
    });

    const embla = EmblaCarousel(
      viewport,
      {
        direction: document.dir === "rtl" ? "rtl" : "ltr",
        loop: true,
        dragFree: true
      },
      [autoScroll]
    );
  })();
</script>
