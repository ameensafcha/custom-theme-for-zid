{#
  Quantity Input Component

  A quantity control for cart items with delete/minus and plus buttons.
  - Quantity = 1: Shows delete icon (removes item)
  - Quantity > 1: Shows minus icon (decreases quantity)

  Props:
    - product_id (string, required): Product ID for cart operations
    - quantity (number, optional): Current quantity (default: 1)

  Usage:
    {% with product_id=item.product.id, quantity=item.quantity %}
      {% include 'components/ui/quantity-input.jinja' %}
    {% endwith %}
#}

{% set qty = quantity | default(1) %}

{# Icon definitions #}
{% set delete_icon %}
  <svg
    class="size-4"
    viewBox="0 0 16 16"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M11.3333 6V12.6667H4.66667V6H11.3333ZM10.1667 2H5.83333L5 2.83333H2V4.5H14V2.83333H11L10.1667 2ZM13 4.33333H3V12.6667C3 13.5833 3.75 14.3333 4.66667 14.3333H11.3333C12.25 14.3333 13 13.5833 13 12.6667V4.33333Z"
      fill="currentColor"
    />
  </svg>
{% endset %}


{% set minus_icon %}
  <svg
    class="size-4"
    viewBox="0 0 16 16"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M4 7.44444V8.55556H12V7.44444H4Z"
      fill="currentColor"
    />
  </svg>
{% endset %}


{% set plus_icon %}
  <svg
    class="size-4"
    viewBox="0 0 16 16"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M12.6667 8.66667H8.66667V12.6667H7.33333V8.66667H3.33333V7.33333H7.33333V3.33333H8.66667V7.33333H12.6667V8.66667Z"
      fill="currentColor"
    />
  </svg>
{% endset %}

<div
  class="quantity-input border-muted flex h-12 items-center gap-2 rounded border px-3 transition-all hover:border-2"
  data-quantity-input
  data-product-id="{{ product_id }}"
  data-quantity="{{ qty }}"
>
  {# Delete button (visible when qty = 1) #}
  {% with content=delete_icon, size='icon-sm', attrs='aria-label="' ~ _("Remove from cart") ~ '" data-quantity-action="remove"' ~ (' hidden' if qty > 1 else '') %}
    {% include 'components/ui/button.jinja' %}
  {% endwith %}

  {# Minus button (visible when qty > 1) #}
  {% with content=minus_icon, size='icon-sm', attrs='aria-label="' ~ _("Decrease quantity") ~ '" data-quantity-action="decrease"' ~ (' hidden' if qty == 1 else '') %}
    {% include 'components/ui/button.jinja' %}
  {% endwith %}

  {# Quantity display #}
  <span
    class="text-foreground text-body2 min-w-12 text-center font-medium"
    data-quantity-display
  >
    {{ qty }}
  </span>

  {# Plus button #}
  {% with content=plus_icon, size='icon-sm', attrs='aria-label="' ~ _("Increase quantity") ~ '" data-quantity-action="increase"' %}
    {% include 'components/ui/button.jinja' %}
  {% endwith %}
</div>
