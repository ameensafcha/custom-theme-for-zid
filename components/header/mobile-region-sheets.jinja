{# Mobile Region Bottom Sheets - Country/Language Selection #}
{% set multiple_countries = store.countries | length > 1 %}
{% set multiple_languages = store.languages | length > 1 %}
{% set show_country = multiple_countries and not safeget(settings, "hide_country", false) %}
{% set show_language = multiple_languages and not safeget(settings, "hide_language", false) %}

{% if show_country or show_language %}
  <div class="flex w-full flex-col items-start gap-2.5 py-0 ps-6 pe-0">
    <div class="flex w-full items-start gap-4">
      {% if show_country %}
        <el-dialog class="contents">
          <button
            type="button"
            command="show-modal"
            commandfor="mobile-country-sheet"
            class="text-foreground text-body1 flex items-center justify-center gap-1 py-2"
          >
            {{ session.country.name }}
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 16 16"
              fill="none"
            >
              <path
                d="M4.7251 6.18231C4.74222 6.18232 4.7492 6.18527 4.75146 6.18622L4.77783 6.20575L7.64502 9.09052L7.99854 9.44598L8.354 9.09149L11.2388 6.20575C11.2466 6.19792 11.2525 6.19402 11.2554 6.19208C11.257 6.19096 11.2579 6.19031 11.2583 6.19012H11.2651C11.2834 6.1908 11.2983 6.19307 11.3276 6.22235C11.3426 6.23728 11.3462 6.24633 11.3472 6.24872C11.3481 6.25095 11.3511 6.25787 11.3511 6.27509C11.3511 6.29208 11.3481 6.29911 11.3472 6.30145C11.3462 6.30384 11.3426 6.31289 11.3276 6.32782L8.04834 9.60712C8.03231 9.62314 8.02229 9.62961 8.01904 9.63153C8.0165 9.63259 8.01164 9.63441 8.00049 9.63446C7.989 9.63446 7.98354 9.63261 7.98096 9.63153L7.95166 9.60712L4.65576 6.31122C4.64868 6.30413 4.64476 6.29909 4.64307 6.29657C4.64222 6.29531 4.64233 6.29409 4.64209 6.29364H4.64111C4.64105 6.29341 4.64128 6.29174 4.64111 6.29071C4.64079 6.28864 4.63986 6.28398 4.64014 6.27606C4.64115 6.24749 4.64677 6.23134 4.67236 6.20575C4.68728 6.19084 4.69635 6.18722 4.69873 6.18622C4.70113 6.18523 4.70822 6.18231 4.7251 6.18231Z"
                fill="currentColor"
                stroke="currentColor"
              ></path>
            </svg>
          </button>
          <dialog
            id="mobile-country-sheet"
            class="fixed inset-0 size-auto max-h-none max-w-none overflow-hidden bg-transparent not-open:hidden backdrop:bg-transparent"
          >
            <el-dialog-backdrop
              class="bg-foreground/10 absolute inset-0 backdrop-blur-xs transition-opacity duration-300 ease-in-out data-closed:opacity-0"
            ></el-dialog-backdrop>
            <div
              tabindex="0"
              class="absolute inset-0 flex items-end justify-center focus:outline-none"
            >
              <el-dialog-panel
                class="w-full transform transition duration-300 ease-in-out data-closed:translate-y-full"
              >
                <div class="bg-background rounded-t-2xl">
                  <div class="flex w-full items-center justify-between px-4 py-2">
                    <div class="size-10"></div>
                    <p class="text-h6 text-foreground text-caps text-center">{{ _("Country") }}</p>
                    <button
                      type="button"
                      command="close"
                      class="flex size-10 items-center justify-center"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M18 6L6 18M6 6L18 18"
                          stroke="currentColor"
                          stroke-width="1.5"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </button>
                  </div>
                  <div class="flex w-full flex-col gap-2 px-0 pt-2 pb-4">
                    {% for country in store.countries %}
                      <button
                        type="button"
                        onclick="selectMobileCountry('{{ country.code | lower }}')"
                        class="text-foreground text-body1 hover:bg-secondary flex h-10 w-full items-center justify-start px-6 py-0 text-start"
                      >
                        {{ country.names[session.lang] if country.names else country.name }}
                      </button>
                    {% endfor %}
                  </div>
                </div>
              </el-dialog-panel>
            </div>
          </dialog>
        </el-dialog>
      {% endif %}
      {% if show_language %}
        <el-dialog class="contents">
          <button
            type="button"
            command="show-modal"
            commandfor="mobile-language-sheet"
            class="text-foreground text-body1 flex items-center justify-center gap-1 py-2"
          >
            {{ session.lang | upper }}
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 16 16"
              fill="none"
            >
              <path
                d="M4.7251 6.18231C4.74222 6.18232 4.7492 6.18527 4.75146 6.18622L4.77783 6.20575L7.64502 9.09052L7.99854 9.44598L8.354 9.09149L11.2388 6.20575C11.2466 6.19792 11.2525 6.19402 11.2554 6.19208C11.257 6.19096 11.2579 6.19031 11.2583 6.19012H11.2651C11.2834 6.1908 11.2983 6.19307 11.3276 6.22235C11.3426 6.23728 11.3462 6.24633 11.3472 6.24872C11.3481 6.25095 11.3511 6.25787 11.3511 6.27509C11.3511 6.29208 11.3481 6.29911 11.3472 6.30145C11.3462 6.30384 11.3426 6.31289 11.3276 6.32782L8.04834 9.60712C8.03231 9.62314 8.02229 9.62961 8.01904 9.63153C8.0165 9.63259 8.01164 9.63441 8.00049 9.63446C7.989 9.63446 7.98354 9.63261 7.98096 9.63153L7.95166 9.60712L4.65576 6.31122C4.64868 6.30413 4.64476 6.29909 4.64307 6.29657C4.64222 6.29531 4.64233 6.29409 4.64209 6.29364H4.64111C4.64105 6.29341 4.64128 6.29174 4.64111 6.29071C4.64079 6.28864 4.63986 6.28398 4.64014 6.27606C4.64115 6.24749 4.64677 6.23134 4.67236 6.20575C4.68728 6.19084 4.69635 6.18722 4.69873 6.18622C4.70113 6.18523 4.70822 6.18231 4.7251 6.18231Z"
                fill="currentColor"
                stroke="currentColor"
              ></path>
            </svg>
          </button>
          <dialog
            id="mobile-language-sheet"
            class="fixed inset-0 size-auto max-h-none max-w-none overflow-hidden bg-transparent not-open:hidden backdrop:bg-transparent"
          >
            <el-dialog-backdrop
              class="bg-foreground/10 absolute inset-0 backdrop-blur-xs transition-opacity duration-300 ease-in-out data-closed:opacity-0"
            ></el-dialog-backdrop>
            <div
              tabindex="0"
              class="absolute inset-0 flex items-end justify-center focus:outline-none"
            >
              <el-dialog-panel
                class="w-full transform transition duration-300 ease-in-out data-closed:translate-y-full"
              >
                <div class="bg-background rounded-t-2xl">
                  <div class="flex w-full items-center justify-between px-4 py-2">
                    <div class="size-10"></div>
                    <p class="text-h6 text-foreground text-caps text-center">{{ _("Language") }}</p>
                    <button
                      type="button"
                      command="close"
                      class="flex size-10 items-center justify-center"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M18 6L6 18M6 6L18 18"
                          stroke="currentColor"
                          stroke-width="1.5"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </button>
                  </div>
                  <div class="flex w-full flex-col gap-2 px-0 pt-2 pb-4">
                    {% for language in store.languages %}
                      <button
                        type="button"
                        onclick="selectMobileLanguage('{{ language.code }}')"
                        class="text-foreground text-body1 hover:bg-secondary flex h-10 w-full items-center justify-start px-6 py-0 text-start"
                      >
                        {{ language.name }}
                      </button>
                    {% endfor %}
                  </div>
                </div>
              </el-dialog-panel>
            </div>
          </dialog>
        </el-dialog>
      {% endif %}
    </div>
  </div>
{% endif %}
