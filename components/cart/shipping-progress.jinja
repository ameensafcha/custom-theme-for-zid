{% if cart.free_shipping_rule and cart.free_shipping_rule.code %}
  {% set subtotal_condition = cart.free_shipping_rule.subtotal_condition %}
  {% set status = cart.free_shipping_rule.subtotal_condition.status | default('') %}
  {% set remaining_amount = subtotal_condition.remaining | default("0") %}
  {% set percentage = subtotal_condition.products_subtotal_percentage_from_min | default(0) %}

  <div
    class="bg-secondary mt-6 flex flex-col gap-4 rounded p-4"
    data-free-shipping-bar
  >
    <p
      class="text-foreground text-tagline text-center"
      data-free-shipping-message
    >
      {% if status == 'min_not_reached' %}
        {{ _("You are") }} <strong>{{ remaining_amount }}</strong>
        {{ _("away from free shipping") }}
      {% elif status == 'applied' %}
        {{ _("You've unlocked free shipping!") }}
      {% else %}
        {{ _("Free shipping available") }}
      {% endif %}
    </p>
    <div class="relative flex items-center">
      <div class="bg-background relative h-1.5 w-full rounded-lg">
        <div
          class="bg-accent absolute inset-y-0 start-0 rounded-lg transition-all duration-300"
          style="width: {{ percentage if status != 'applied' else 100 }}%"
          data-free-shipping-progress-bar
        ></div>
        <div
          class="bg-accent absolute top-1/2 flex size-6 -translate-y-1/2 items-center justify-center rounded-full transition-all duration-300"
          style="inset-inline-start: calc({{ percentage if status != 'applied' else 100 }}% - 12px)"
          data-free-shipping-truck
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            class="text-background size-4 rtl:-scale-x-100"
            viewBox="0 0 16 16"
            fill="none"
          >
            <path
              d="M3.75 2.46875H11.3828C11.5517 2.46875 11.6933 2.53716 11.8076 2.67676C11.9216 2.81599 11.9608 2.96909 11.9268 3.1377L11.3936 5.42676L11.3867 5.45703H12.9297C13.1074 5.45703 13.274 5.49614 13.4297 5.57324C13.5853 5.6502 13.7161 5.75817 13.8213 5.89844L15.1104 7.62988C15.2092 7.76578 15.2749 7.90645 15.3066 8.05078C15.3305 8.15943 15.3374 8.27203 15.3281 8.38867L15.3135 8.50586L14.8184 10.9941C14.7924 11.1228 14.7291 11.2302 14.627 11.3154C14.5248 11.4007 14.4089 11.4433 14.2793 11.4434H13.3428L13.3457 11.4707C13.4005 12.0294 13.2433 12.5114 12.874 12.918C12.5047 13.3243 12.0371 13.5273 11.4697 13.5273C10.9021 13.5273 10.437 13.3236 10.0732 12.916C9.70936 12.5082 9.55552 12.027 9.61035 11.4707L9.6123 11.4434H6.34277L6.3457 11.4707C6.40052 12.0294 6.24333 12.5114 5.87402 12.918C5.50466 13.3243 5.03711 13.5273 4.46973 13.5273C3.9021 13.5273 3.43697 13.3236 3.07324 12.916C2.70936 12.5082 2.55552 12.027 2.61035 11.4707L2.6123 11.4434H1.59082C1.43699 11.4434 1.30845 11.3909 1.2041 11.2861C1.09989 11.1813 1.04787 11.0521 1.04785 10.8975C1.04785 10.7427 1.10002 10.6145 1.2041 10.5117C1.30842 10.4089 1.43685 10.3574 1.59082 10.3574H3.14453L3.15137 10.3496C3.31033 10.1735 3.50249 10.033 3.72754 9.92969C3.95189 9.8266 4.19894 9.77542 4.46875 9.77539C4.73869 9.77539 4.98568 9.82743 5.20898 9.93066C5.43269 10.0343 5.62529 10.1739 5.78711 10.3496L5.79492 10.3574H9.14551L9.15039 10.3379L9.34863 9.47266L9.3916 9.30371C9.45713 9.04039 9.52924 8.72134 9.6084 8.34766L9.81543 7.44629C9.83463 7.3641 9.85019 7.28771 9.86914 7.21875V7.21777L9.97559 6.7832C10.0467 6.49287 10.1275 6.13447 10.2178 5.70898C10.2385 5.61122 10.2607 5.51744 10.2803 5.42676L10.7031 3.58887L10.71 3.55762H3.7334C3.57387 3.55762 3.44658 3.50538 3.34961 3.40137C3.25218 3.29673 3.20316 3.1677 3.20312 3.0127C3.20312 2.8582 3.25525 2.72941 3.35938 2.625C3.46352 2.52075 3.59334 2.46875 3.75 2.46875ZM4.46973 10.8604C4.26033 10.8604 4.07629 10.9371 3.91797 11.0879C3.75897 11.2392 3.67878 11.4271 3.67871 11.6504C3.67871 11.8602 3.75843 12.045 3.91602 12.2031C4.07404 12.3616 4.26214 12.4414 4.47754 12.4414C4.69273 12.4413 4.87747 12.3622 5.03027 12.2041C5.18309 12.046 5.25976 11.8586 5.25977 11.6436C5.25977 11.4287 5.18428 11.2439 5.0332 11.0908C4.88164 10.9374 4.6929 10.8604 4.46973 10.8604ZM11.4697 10.8604C11.2603 10.8604 11.0763 10.9371 10.918 11.0879C10.759 11.2392 10.6788 11.4271 10.6787 11.6504C10.6787 11.8602 10.7584 12.045 10.916 12.2031C11.074 12.3616 11.2621 12.4414 11.4775 12.4414C11.6927 12.4413 11.8775 12.3622 12.0303 12.2041C12.1831 12.046 12.2598 11.8586 12.2598 11.6436C12.2598 11.4287 12.1843 11.2439 12.0332 11.0908C11.8816 10.9374 11.6929 10.8604 11.4697 10.8604ZM11.1309 6.5625L10.6074 8.84375L10.6006 8.87402H14.1201L14.124 8.85352L14.2324 8.28027L14.2344 8.26855L14.2275 8.25977L12.9502 6.55273L12.9424 6.54297H11.1348L11.1309 6.5625ZM1.00977 7.68164H3.67969C3.83352 7.68164 3.96217 7.7341 4.06641 7.83887C4.1706 7.94374 4.22266 8.07289 4.22266 8.22754C4.22262 8.38226 4.17046 8.5105 4.06641 8.61328C3.96224 8.71597 3.83356 8.76758 3.67969 8.76758H0.992188C0.832879 8.76747 0.706225 8.71466 0.609375 8.61133C0.51184 8.50722 0.462908 8.37894 0.462891 8.22461C0.462891 8.07052 0.51426 7.94209 0.617188 7.83789C0.719846 7.73403 0.85026 7.68164 1.00977 7.68164ZM2.32617 5.15625H5.67578C5.82916 5.15625 5.95858 5.21 6.06445 5.31641C6.17002 5.42287 6.22266 5.55282 6.22266 5.70703C6.22258 5.86133 6.16986 5.98902 6.06445 6.0918C5.95863 6.19475 5.82942 6.24609 5.67578 6.24609H2.32617C2.16954 6.24609 2.03981 6.19356 1.93555 6.08887C1.83144 5.98418 1.77937 5.85556 1.7793 5.70117C1.7793 5.54674 1.83136 5.4179 1.93555 5.31348C2.03981 5.20911 2.16952 5.15625 2.32617 5.15625Z"
              fill="white"
              stroke="white"
              stroke-width="0.05"
            ></path>
          </svg>
        </div>
      </div>
    </div>
  </div>
{% endif %}