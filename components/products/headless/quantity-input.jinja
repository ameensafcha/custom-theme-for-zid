{#
  Quantity Input
  Renders a quantity selector with +/- buttons.
  See docs/headless/quantity-input.md for full documentation.

  Parameters:
    - quantity (number): Initial value (default: 1)
    - min (number): Minimum quantity (default: 1)
    - max (number): Maximum quantity (default: none)
#}

{% set current_quantity = quantity|default(1) %}
{% set min_qty = min|default(1) %}
{% set max_qty = max %}
{% set has_max = max is not none and max %}

<div class="quantity-input">
  <button
    type="button"
    class="quantity-input__button quantity-input__decrease"
    onclick="(function(btn) {
      var input = btn.parentElement.querySelector('#product-quantity');
      var current = parseInt(input.value) || 1;
      var min = parseInt(input.min) || 1;
      if (current > min) {
        input.value = current - 1;
        input.dispatchEvent(new Event('change', { bubbles: true }));
      }
    })(this)"
    aria-label="{{ _('Decrease quantity') }}"
  >
    <svg
      class="quantity-input__icon"
      width="16"
      height="16"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
    >
      <path d="M5 12h14"></path>
    </svg>
  </button>

  <input
    type="number"
    id="product-quantity"
    name="quantity"
    value="{{ current_quantity }}"
    min="{{ min_qty }}"
    {% if has_max %}max="{{ max_qty }}"{% endif %}
    class="quantity-input__input"
    aria-label="{{ _('Quantity') }}"
  />

  <button
    type="button"
    class="quantity-input__button quantity-input__increase"
    onclick="(function(btn) {
      var input = btn.parentElement.querySelector('#product-quantity');
      var current = parseInt(input.value) || 1;
      var maxAttr = input.getAttribute('max');
      var max = maxAttr ? parseInt(maxAttr) : Infinity;
      if (current < max) {
        input.value = current + 1;
        input.dispatchEvent(new Event('change', { bubbles: true }));
      }
    })(this)"
    aria-label="{{ _('Increase quantity') }}"
  >
    <svg
      class="quantity-input__icon"
      width="16"
      height="16"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
    >
      <path d="M12 5v14"></path>
      <path d="M5 12h14"></path>
    </svg>
  </button>
</div>
