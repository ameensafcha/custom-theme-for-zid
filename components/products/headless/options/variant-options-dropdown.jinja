{#
  Variant Options - Dropdown Style
  Renders select dropdowns for variant selection.
  See docs/headless/variant-options-dropdown.md for full documentation.
#}

{% if options %}
  {# Hidden parent ID - REQUIRED by product.js #}
  {% if product and product.has_variants %}
    <input
      id="product-parent-id"
      type="hidden"
      value="{{ product.id }}"
    />
  {% endif %}

  <div
    id="product-variants-options"
    class="product-options product-options--dropdown"
  >
    {% for option in options %}
      {% set option_index = loop.index0 %}

      <div
        class="product-options__group"
        index="{{ option_index }}"
      >
        <label
          class="product-options__label"
          for="option-{{ option.id }}"
        >
          {{ option.name }}
        </label>

        <select
          name="{{ option.name }}"
          id="option-{{ option.id }}"
          data-option-id="{{ option.id }}"
          index="{{ option_index }}"
          onchange="productOptionInputChanged(event)"
          required
          class="product-options__select"
        >
          {% for choice in option.choices %}
            {% set is_selected = false %}
            {% if product and product.selected_product and product.selected_product.attributes %}
              {% if product.selected_product.attributes[option_index] %}
                {% if product.selected_product.attributes[option_index].value == choice %}
                  {% set is_selected = true %}
                {% endif %}
              {% endif %}
            {% endif %}

            <option
              value="{{ choice }}"
              {% if is_selected %}selected{% endif %}
            >
              {{ choice }}
            </option>
          {% endfor %}
        </select>
      </div>
    {% endfor %}
  </div>
{% endif %}
