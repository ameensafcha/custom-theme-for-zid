<div
  id="sticky-cta"
  class="bg-secondary border-border-light fixed inset-x-0 bottom-0 z-40 hidden border-t px-4 py-4 transition-transform transition-discrete duration-300 md:px-16 starting:translate-y-full"
  data-sticky-cta
  aria-hidden="true"
>
  <div class="theme-container">
    <div class="flex items-center gap-4">
      {# Product Image #}
      <div class="size-16 shrink-0 overflow-hidden rounded">
        {% if product.images and product.images|length > 0 %}
          {% set img_src = product.images[0].image.thumbnail if product.images[0].image else product.images[0] %}
          <img
            src="{{ image_url(img_src, w=128, q=85, f='auto') }}"
            alt="{{ product.name }}"
            class="size-full object-cover"
            data-sticky-cta-image
          />
        {% else %}
          <div class="bg-background size-full"></div>
        {% endif %}
      </div>

      {# Product Info #}
      <div class="flex min-w-0 flex-1 items-center gap-4">
        <div class="min-w-0 flex-1">
          {# Product Name #}
          <h3
            class="text-foreground text-h6 truncate"
            data-sticky-cta-name
          >
            {{ product.name }}
          </h3>
          {# Selected Options #}
          <p
            class="text-muted text-tagline truncate"
            data-sticky-cta-options
          >
            {# Will be populated by JS when variant changes #}
          </p>
        </div>

        {# Price #}
        <div class="shrink-0">
          <span
            class="text-foreground text-h6"
            data-sticky-cta-price
          >
            {{ product.formatted_sale_price if product.formatted_sale_price else product.formatted_price }}
          </span>
        </div>
      </div>

      {# In Stock State #}
      <div
        class="{{ 'hidden' if not product.in_stock }} flex items-center gap-4"
        data-sticky-cta-in-stock
      >
        {# Quantity Input #}
        <div class="hidden shrink-0 sm:block">
          {% with id='sticky-qty', name='sticky_quantity', sync_target='product-quantity' %}
            {% include 'components/ui/quantity-input.jinja' %}
          {% endwith %}
        </div>

        {# Add to Cart Button #}
        <button
          type="button"
          class="btn btn-filled btn-lg shrink-0 transition-all duration-200"
          data-sticky-cta-add-to-cart
        >
          {# Default state #}
          <span
            class="inline-flex items-center gap-2"
            data-sticky-cta-btn-default
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="hidden sm:block"
            >
              <circle
                cx="8"
                cy="21"
                r="1"
              ></circle>
              <circle
                cx="19"
                cy="21"
                r="1"
              ></circle>
              <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"></path>
            </svg>
            <span>{{ _("Add to cart") }}</span>
          </span>
          {# Loading state #}
          <span
            class="hidden items-center gap-2"
            data-sticky-cta-btn-loading
          >
            <svg
              class="size-5 animate-spin"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M21 12a9 9 0 1 1-6.219-8.56" />
            </svg>
          </span>
          {# Success state #}
          <span
            class="hidden items-center gap-2"
            data-sticky-cta-btn-success
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
            <span>{{ _("Added!") }}</span>
          </span>
        </button>
      </div>

      {# Out of Stock State #}
      <div
        class="{{ 'hidden' if product.in_stock }} flex items-center gap-2"
        data-sticky-cta-out-of-stock
      >
        {# Notify Me Button #}
        <button
          type="button"
          class="btn btn-filled btn-lg shrink-0"
          command="show-modal"
          commandfor="notify-me-dialog"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="hidden sm:block"
          >
            <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"></path>
            <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"></path>
          </svg>
          <span>{{ _("Notify me when available") }}</span>
        </button>
      </div>
    </div>
  </div>
</div>
